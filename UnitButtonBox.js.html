<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8" />
		<base data-ice="baseUrl" href="./" />
		<title data-ice="title">src/UnitButtonBox.js | rwof</title>
		<link type="text/css" rel="stylesheet" href="css/style.css" />
		<link
			type="text/css"
			rel="stylesheet"
			href="css/prettify-tomorrow.css"
		/>
		<script src="script/prettify/prettify.js"></script>
		<script src="script/manual.js"></script>
	</head>
	<body class="layout-container" data-ice="rootContainer">
		<header>
			<a href="./">Home</a>
		</header>

		<nav class="navigation" data-ice="nav">
			<div>
				<ul>
					<li data-ice="doc">
						<span data-ice="kind" class="kind-class">C</span
						><span data-ice="name"
							><span
								><a href="UnitButton.js~UnitButton.html"
									>UnitButton</a
								></span
							></span
						>
					</li>
					<li data-ice="doc">
						<span data-ice="kind" class="kind-class">C</span
						><span data-ice="name"
							><span
								><a href="UnitButtonBox.js~UnitButtonBox.html"
									>UnitButtonBox</a
								></span
							></span
						>
					</li>
				</ul>
			</div>
		</nav>

		<div class="content" data-ice="content">
			<h1 data-ice="title">src/UnitButtonBox.js</h1>
			<pre
				class="source-code line-number raw-source-code"
			><code class="prettyprint linenums" data-ice="content">import React from &apos;react&apos;;
import cx from &apos;classnames&apos;;
import PropTypes from &apos;prop-types&apos;;
import UnitButton from &apos;./UnitButton&apos;;

/**
 * UnitButtonBox has left/right mouse button controls, as well as
 * clickable, hoverable, buttons that are highlighted when active.
 * @reactProps {string[]} buttonValues - strings to be mapped to UnitButtons
 * @reactProps {string} title - the unit title for this set of values
 * @reactProps {string} classname - a string to assign the class name for the button box
 * @reactProps {function} onEvent - a handleUnitChange function from Main to deal with unit change.
 * @reactProps {function} change - flips the selected image index forward or back in DataCanvasContainer
 *                                (parent) so the selected image updates in the DataCanvas
 */
export default class UnitButtonBox extends React.Component {
  /**
   * store the current unit selection as the value itself of that unit
   * for conditional style (highlight)
   */
  state = {
    selected: this.props.buttonValues[0],
  }

  /**
   * Add event key listener
   */
  componentDidMount() {
    document.addEventListener(&quot;keydown&quot;, this.onArrowDown);
  }

  /**
   * Remove event key listener
   */
  componentWillUnmount () {
    document.removeEventListener(&quot;keydown&quot;, this.onArrowDown);
  }

  /**
   * generator returns the index of selected
   */
  get selectedIndex () {
      const {
          props: {
              buttonValues: values
          },
          state: {
              selected
          }
      } = this;

      return (values || []).indexOf(selected);
  }

  /**
   * Highlight stores the current selection,
   * passes that index up to DataCanvasContainer
   * and sends the selected unit to Main for handling the img src
   */
  highlight = (value) =&gt; {
    this.setState({ selected: value });
    this.props.onEvent(value);
    this.props.change(this.selectedIndex);
  }

  /**
   * onArrowDown handles the logic of the arrow key listeners.
   * selected index increases or decreases with respect to button values
   * and values are highlighted as arrow keys are pressed.
   * @param {event deconstructed to key type} key - the ArrowLeft or ArrowRight
   */
  onArrowDown = ({ key }) =&gt; {
    const {buttonValues: values = []} = this.props;
    //const i = ~this.selectedIndex ? 0 : this.selectedIndex;
    const keyMap = {
      ArrowLeft: () =&gt; values[this.selectedIndex &gt; 0 ? this.selectedIndex-1 : values.length-1],
      ArrowRight: () =&gt; values[this.selectedIndex &lt; values.length-1 ? this.selectedIndex+1 : 0],
    }
    const fn = keyMap[key];

    //console.log(typeof fn === &apos;function&apos;);

    this.highlight(fn());
    //this.props.change(this.selectedIndex);
    if(!fn || !fn()) {
      return;
    }
  }

  /**
   * Renders a button-box of a buttons box filled with unit buttons.
   * @return div &gt; div &gt; h3, div &gt; UnitButtons
   */
  render() {
    const {classname, title, buttonValues: buttons} = this.props;
    return (
      &lt;div className={cx(&quot;button-box&quot;, classname)}&gt;
        &lt;div className=&quot;title&quot;&gt;
          &lt;h3&gt;{title}&lt;/h3&gt;
        &lt;/div&gt;
        &lt;div className=&quot;buttons&quot;&gt;
          {buttons.map(
                    (val, i) =&gt; (
                      &lt;UnitButton selected={val === this.state.selected}
                              value={val}
                              label={(Number(val))}
                              highlight={this.highlight}
                              key={i}

                        /&gt;
                      ))}
        &lt;/div&gt;
      &lt;/div&gt;
    );
  }
}

UnitButtonBox.propTypes = {
  title: PropTypes.string,
  classname: PropTypes.string,
  buttonValues: PropTypes.array,
  onEvent: PropTypes.func,
  change: PropTypes.func
}
</code></pre>
		</div>

		<footer class="footer">
			Generated by
			<a href="https://esdoc.org"
				>ESDoc<span data-ice="esdocVersion">(1.1.0)</span
				><img src="./image/esdoc-logo-mini-black.png"
			/></a>
		</footer>

		<script src="script/pretty-print.js"></script>
		<script src="script/inherited-summary.js"></script>
		<script src="script/inner-link.js"></script>
		<script src="script/patch-for-local.js"></script>
	</body>
</html>
